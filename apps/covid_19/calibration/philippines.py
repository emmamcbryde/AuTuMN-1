from autumn.constants import Region
from apps.covid_19.calibration import base


def run_calibration_chain(max_seconds: int, run_id: int):
    base.run_calibration_chain(
        max_seconds, run_id, Region.PHILIPPINES, PAR_PRIORS, TARGET_OUTPUTS, mode="autumn_mcmc",
    )


PAR_PRIORS = [
    {
        "param_name": "contact_rate", 
        "distribution": "uniform", 
        "distri_params": [0.010, 0.05],
    },
    {
        "param_name": "start_time", 
        "distribution": "uniform", 
        "distri_params": [0.0, 40.0],
    },
    # Add extra params for negative binomial likelihood
    {
        "param_name": "infection_deathsXall_dispersion_param",
        "distribution": "uniform",
        "distri_params": [0.1, 5.0],
    },
    {
        "param_name": "notifications_dispersion_param",
        "distribution": "uniform",
        "distri_params": [0.1, 5.0],
    },
    {
        "param_name": "compartment_periods_calculated.incubation.total_period",
        "distribution": "gamma",
        "distri_mean": 5.0,
        "distri_ci": [4.4, 5.6],
    },
    {
        "param_name": "compartment_periods_calculated.total_infectious.total_period",
        "distribution": "gamma",
        "distri_mean": 7.0,
        "distri_ci": [4.5, 9.5],
    },
    # parameters to derive age-specific IFRs
    {
        "param_name": "ifr_double_exp_model_params.k",
        "distribution": "uniform",
        "distri_params": [8., 16.],
    },
    {
        "param_name": "ifr_double_exp_model_params.last_representative_age",
        "distribution": "uniform",
        "distri_params": [75., 85.],
    },
]

# death data:
death_times = [
      71,
      72,
      73,
      74,
      75,
      76,
      77,
      78,
      79,
      80,
      81,
      82,
      83,
      84,
      85,
      86,
      87,
      88,
      89,
      90,
      91,
      92,
      93,
      94,
      95,
      96,
      97,
      98,
      99,
     100,
     101,
     102,
     103,
     104,
     105,
     106,
     107,
     108,
     109,
     110,
     111,
     112,
     113,
     114,
     115,
     116,
     117,
     118,
     119,
     120,
     121,
     122,
     123,
     124,
     125,
     126,
     127,
     128,
     129,
     130,
     131,
     132,
     133,
     134,
     135,
     136,
     137,
     138,
     139,
     140,
     141,
     142,
     143,
     144,
     145,
     146,
     147,
     148,
     149,
     150,
     151,
     152,
     153,
     154,
     155,
     156,
     157,
     158,
     159,
     160,
     161,
     162,
     163,
     164,
     165,
     166,
     167,
     168,
     169,
     170,
     171,
     172,
     173,
     174,
     175,
]

death_values = [      
      2,
      3,
      4,
      3,
      5,
      6,
     11,
     12,
     13,
     14,
     13,
     27,
     31,
     23,
     19,
     36,
     38,
     33,
     31,
     39,
     27,
     30,
     26,
     20,
     27,
     25,
     20,
     15,
     20,
     16,
     19,
     22,
     15,
     24,
     12,
     19,
      5,
      9,
     16,
     10,
     15,
     11,
     12,
     19,
      8,
     11,
      6,
     16,
      4,
      7,
      9,
      6,
      9,
      8,
      8,
      6,
     14,
      5,
      3,
     15,
      3,
     10,
      5,
     10,
     12,
     10,
      7,
      4,
      4,
     15,
      3,
      6,
     13,
      7,
      2,
      7,
      4,
      4,
      4,
      6,
      5,
      2,
      5,
      3,
      4,
     10,
      5,
      4,
      5,
      5,
      9,
     10,
      9,
      1,
     10,
     13,
      8,
      5,
      7,
      2,
      1,
      2,
      6,
      3,
      1,
]

# notification data:
notification_times = [
      41,
      43,
      44,
      48,
      51,
      53,
      54,
      56,
      58,
      61,
      62,
      63,
      64,
      65,
      66,
      67,
      68,
      69,
      70,
      71,
      72,
      73,
      74,
      75,
      76,
      77,
      78,
      79,
      80,
      81,
      82,
      83,
      84,
      85,
      86,
      87,
      88,
      89,
      90,
      91,
      92,
      93,
      94,
      95,
      96,
      97,
      98,
      99,
     100,
     101,
     102,
     103,
     104,
     105,
     106,
     107,
     108,
     109,
     110,
     111,
     112,
     113,
     114,
     115,
     116,
     117,
     118,
     119,
     120,
     121,
     122,
     123,
     124,
     125,
     126,
     127,
     128,
     129,
     130,
     131,
     132,
     133,
     134,
     135,
     136,
     137,
     138,
     139,
     140,
     141,
     142,
     143,
     144,
     145,
     146,
     147,
     148,
     149,
     150,
     151,
     152,
     153,
     154,
     155,
     156,
     157,
     158,
     159,
     160,
     161,
     162,
     163,
     164,
     165,
     166,
     167,
     168,
     169,
     170,
     171,
     172,
     173,
     174,
     175,
     176,
     177,
     178,
]

notification_values = [
        1,
        1,
        2,
        1,
        1,
        1,
        1,
        1,
        1,
        4,
        3,
        3,
        7,
       10,
       17,
       15,
       12,
       27,
       42,
       51,
       63,
       65,
      100,
      128,
      133,
      136,
      147,
      140,
      167,
      178,
      162,
      192,
      266,
      194,
      232,
      257,
      202,
      177,
      227,
      183,
      186,
      232,
      195,
      176,
      172,
      234,
      251,
      230,
      225,
      290,
      267,
      194,
      187,
      186,
      213,
      188,
      341,
      154,
      190,
      254,
      242,
      219,
      167,
      263,
      253,
      213,
      285,
      323,
      235,
      238,
      352,
      174,
      136,
      257,
      289,
      273,
      266,
      196,
      173,
      183,
      242,
      280,
      188,
      211,
      232,
      194,
      308,
      269,
      378,
      461,
      571,
      797,
      712,
      402,
      685,
      456,
      416,
      749,
      538,
      480,
      608,
      759,
      590,
      550,
      506,
      523,
      551,
      464,
      444,
      401,
      423,
      601,
      783,
      614,
     1069,
      589,
      920,
      897,
      747,
      602,
      835,
      721,
      749,
      202,
       42,
        9,
        9,
]

TARGET_OUTPUTS = [
    {
        "output_key": "infection_deathsXall",
        "years": death_times,
        "values": death_values,
        "loglikelihood_distri": "negative_binomial",
    },
    {
        "output_key": "notifications",
        "years": notification_times,
        "values": notification_values,
        "loglikelihood_distri": "negative_binomial",
    },

]
